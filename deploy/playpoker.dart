import "dart:html" as o;import "dart:math" as oB;class pB{final  name;const pB(this.name);}main(){var g=new GB();g.k=g.RB();g.t=g.iB();for(int h=1;h<6;h++ ){o.query('#h${h}').onClick.listen((qB){if(g.state==1)m.XB(g,h);});}g.SB();o.query("#newHand").onClick.listen((qB){g.SB();});o.query("#showdown").onClick.listen((qB){if(m.u.values.contains(true)){g.nB();}else{g.TB();}});}class GB{var state;var k;var t;var NB=[] ; RB(){var g=new AB();g.CB=[] ;g.j=[] ;g.k=true;return g;} iB(){var g=RB();g.k=false;return g;} jB(){state=0;NB=[] ;k.j=[] ;t.j=[] ;k.CB=[] ;t.CB=[] ;} MB( h){while (h.j.length<5){var g=kB();if(cB(g)==false){NB.add(g);h.j.add(g);}}} kB(){var g,i;var h=new oB.Random();g=h.nextInt(4);i=2+h.nextInt(13);var l=new s(g,i);return l;} cB( h){for(var g in NB){if(g.LB()==h.LB()){return true;}}return false;} JB( g){var h=new Map();for(var i in g.j){if(h[i.r]==null){h[i.r]=1;}else{h[i.r]++;}}var l=0;for(var q in h.values){l+= oB.pow(q,2);}g.v=l;switch (l){case 5:bB(g);break;case 7:g.p='Pair';break;case 11:g.p='Three Of A Kind';break;case 9:g.p='Two Pairs';break;case 13:g.p='Fullhouse';break;case 17:g.p='Four Of A Kind';break;}return g.p;} bB( g){var h=[g.j[0].r,g.j[1].r,g.j[2].r,g.j[3].r,g.j[4].r];h.sort();if(h[4]==h[0]+4){if(this.KB(g)){g.p='Straight Flush';g.v=18;}else{g.p='Straight';g.v=12;}}else if(h[4]==14&&h[0]==2&&h[3]==5){if(this.KB(g)){g.p='Straight Flush';g.v=18;}else{g.p='Straight';g.v=12;}}else{if(this.KB(g)){g.p='Flush';g.v=14;}else{g.p='High Card';g.v=1;}}} KB( g){var i=[g.j[0].n,g.j[1].n,g.j[2].n,g.j[3].n,g.j[4].n];for(var h=0;h<i.length-1;h++ ){if(i[h]!=i[h+1]){return false;}}return true;} dB(){if(k.v>t.v){return {"humanWinner":true,"reason":"you have a higher hand."};}else if(k.v==t.v){switch (k.v){case 1:return eB();case 7:return fB();case 9:return hB();case 11:return gB();}}return {"humanWinner":false,"reason":"you have a lower hand."};} eB(){var i=new s(0,0);var h=new s(0,0);for(var g in k.j){if(g>i){i=g;}}for(var g in t.j){if(g>h){h=g;}}if(i>h){return {"humanWinner":true,"reason":"you have a higher High Card"};}else{return {"humanWinner":false,"reason":"you have a lower High Card"};}} fB(){var l=new Map();for(var g in k.j){if(l[g.r]==null){l[g.r]=[g];}else{l[g.r].add(g);}}var i=new Map();for(var g in t.j){if(i[g.r]==null){i[g.r]=[g];}else{i[g.r].add(g);}}var BB;var DB=[] ;l.forEach((w,h){if(h.length==2){BB=w;DB=h;}});var q;var HB=[] ;i.forEach((w,h){if(h.length==2){q=w;HB=h;}});if(BB>q){return {"humanWinner":true,"reason":"you have a higher Pair."};}else if(BB<q){return {"humanWinner":false,"reason":"you have a lower Pair."};}else{var EB=false;for(var FB in DB){if(FB.n==3)EB=true;}if(EB){return {"humanWinner":true,"reason":"you have the card of Spades."};}return {"humanWinner":false,"reason":"computer has the card of Spades."};}} hB(){var i=false;var q={};var w={};var h=[] ;var l=[] ;for(var g in k.j){if(q[g.r.toString()]==null)q[g.r.toString()]=1;else q[g.r.toString()]++;}for(var g in t.j){if(w[g.r.toString()]==null)w[g.r.toString()]=1;else w[g.r.toString()]++;}q.forEach((DB,BB){if(BB==2){h.add(DB);}});w.forEach((DB,BB){if(BB==2){l.add(DB);}});h.sort();l.sort();var EB=int.parse(h[0].toString());var HB=int.parse(l[0].toString());var FB=int.parse(h[1].toString());var VB=int.parse(l[1].toString());if(FB>VB){return {"humanWinner":true,"reason":"you have a higher Two Pairs."};}else if(FB<VB){return {"humanWinner":false,"reason":"you have a lower Two Pairs."};}else{if(EB>HB){return {"humanWinner":true,"reason":"you have a higher Two Pairs."};}else if(EB<HB){return {"humanWinner":false,"reason":"you have a lower Two Pairs."};}else{for(var g in k.j){if(g.r==FB){if(g.n==3){i=true;}}}if(!i){for(var g in k.j){if(g.r==EB){if(g.n==3){i=true;}}}}if(i){return {"humanWinner":true,"reason":"you have the card of Spades."};}return {"humanWinner":false,"reason":"computer has the card of Spades."};}}} gB(){var h={};var i={};var BB;var w;for(var g in k.j){if(h[g.r.toString()]==null)h[g.r.toString()]=1;else h[g.r.toString()]++;}for(var g in t.j){if(i[g.r.toString()]==null)i[g.r.toString()]=1;else i[g.r.toString()]++;}h.forEach((q,l){if(l==3)BB=int.parse(q);});i.forEach((q,l){if(l==3)w=int.parse(q);});if(BB>w){return {"humanWinner":true,"reason":"you have a higher Three Of A Kind."};}return {"humanWinner":false,"reason":"you have a lower Three Of A Kind."};} SB(){m.WB(this);state=0;mB();} mB(){state=1;MB(k);MB(t);m.OB(this);JB(k);JB(t);m.IB('You have a <b>${k.p}</b>. You can now change up to 4 cards or jump to showdown');} nB(){state=2;for(s g in k.CB){k.j.remove(g);}MB(k);JB(k);TB();} TB(){state=3;m.OB(this,showdown:true);m.PB();m.ZB();m.IB('You have a <b>${k.p}</b>,' ' computer has a <b>${t.p}</b>: ' '${m.YB(this.dB())}');}}class m{static var u={"h1":false,"h2":false,"h3":false,"h4":false,"h5":false};static  WB( g){g.jB();u["h1"]=false;u["h2"]=false;u["h3"]=false;u["h4"]=false;u["h5"]=false;aB();var h=['c1','c2','c3','c4','c5','h1','h2','h3','h4','h5'];for(var i in h){o.query('#${i}').style..backgroundImage='url(img/deck.png)'..width='71px'..height='96px';}PB();}static  OB( h,{ showdown: false}){for(var g=0;g<5;g++ ){o.query('#h${g+1}').style..backgroundImage='url(${h.k.j[g].QB()})'..width='71px'..height='96px';}if(showdown){for(var g=0;g<5;g++ ){o.query('#c${g+1}').style..backgroundImage='url(${h.t.j[g].QB()})'..width='71px'..height='96px';}}}static  XB( h, g){var i;if(m.u["h${g}"]){m.u["h${g}"]=!m.u["h${g}"];h.k.CB.remove(h.k.j[g-1]);i=0;}else{if(h.k.CB.length!=4){h.k.CB.add(h.k.j[g-1]);m.u["h${g}"]=!m.u["h${g}"];i=25;}else{i=0;m.IB("You can change only 4 cards.");}}if(m.u.values.contains(true)){o.query("#showdown")..classes=["btn","btn-success"]..text="Change cards and jump to Showdown";}else{o.query("#showdown")..classes=["btn","btn-info"]..text="Showdown";}o.query("#h${g}").style.marginTop="-${i}px";}static  YB( h){var g;if(h["humanWinner"]){g="you won ";}else{g="computer won ";}g=g+"because "+h["reason"];return g;}static  IB( g){o.query('#status').innerHtml=g;}static  PB(){o.query('#h1').style.marginTop='0px';o.query('#h2').style.marginTop='0px';o.query('#h3').style.marginTop='0px';o.query('#h4').style.marginTop='0px';o.query('#h5').style.marginTop='0px';}static  ZB(){o.query("#showdown").style..visibility='hidden'..display='none';}static  aB(){o.query("#showdown")..text="Showdown"..classes=["btn","btn-info"]..style.visibility='visible'..style.display='inline';}}class s{var r,n;var UB=['Clubs','Diamonds','Hearts','Spades'];var lB=['None','None','2','3','4','5','6','7','8','9','10','Jack','Queen','King','Ace'];s(this.n,this.r){} LB(){return '${lB[this.r]} of ${UB[this.n]}';} toString()=>this.LB(); QB()=>'cards/${UB[this.n][0].toLowerCase()}${this.r}.png';operator>( g){if(this.r>g.r){return true;}else if(this.r==g.r){if(this.n>g.n){return true;}}return false;}operator<( g){if(this.r<g.r){return true;}else if(this.r==g.r){if(this.n<g.n){return true;}}return false;}operator==( g){if(this.r==g.r&&this.n==g.n)return true;return false;}}class AB{var k;var j=[] ;var CB=[] ;var p;var v;}